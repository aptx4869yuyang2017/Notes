---
created: 2024-03-20
tags:
  - domain/data
type: "[[Chapter]]"
up:
  - "[[DAX 权威指南(book)]]"
related: 
ch: "02"
finished:
---

- 迁移笔记 待更新


![500](https://s1.vika.cn/space/2024/03/20/d7404740b70b413697f07a50cbc6df19)
![500](https://s1.vika.cn/space/2024/03/20/79c7f983c3b04dd8a1bb744d31b966c7)


## 理解计算列与度量值


**不同数据模式下计算列的计算差异**

- 如果使用 Import 模式，计算列在刷新的时候会重新计算然后存储在数据模型之中
- DirectQuery 是则是每次计算引擎查询的时候计算，这也许会造成更重的计算查询负担，造成一个慢模型

**计算列度量值的差异**

- 度量值依赖筛选上下文，也就是依赖用户在报表上的行为
- 计算列依赖行上下文，在数据刷新的时候会更新

**必须使用计算列的场景**

1. 必须使用到
	- 要放入切片器
	- 要放入矩阵的行列中
	- 要在DAX查询中作为一个筛选条件
2. 定义一个表达式是严格和当前行绑定的
3. 分类分组的字段 比如 年龄 0-18 这个字段要被筛选器切片器用到


## 变量

[[DAX-CH06-变量]]


- Lazy Evaluation 惰性求值
- 变量的上下文


## DAX表达式错误

BLANK () = 0     -- Always returns TRUE
BLANK () = ""    -- Always returns TRUE

可能在列判断中并不是返回你想要的信息。

**Intercepting errors 拦截错误**

- 使用 iferror 往往性能不好，提前判断不让报错往往更快性能更好。
- 不要在嵌套的函数外面使用 错误拦截函数，要在具体的可能生成的位置拦截错误
- 要主动报错，不是隐藏错误

```
= IF (
         Test[Temperature] >= 0,
         SQRT ( Test[Temperature] ),
         ERROR ( "The temperature cannot be a negative number. Calculation aborted." )

)
```

## 基础函数

### 逻辑函数

- 以前可能会用 switch 来判断参数表选中的值，但是现在有计算组概念了[[DAX-CH09-calculation groups 计算组]]
- switch 也可用来多条件判断


### 信息函数



## 总结

- 计算列是使用DAX表达式计算出来的表中的列。计算列在数据刷新时进行计算，并且不会根据用户选择而改变其值。
- 度量值是用DAX表示的计算结果。与计算列不同，度量值在查询时进行计算。因此，度量值的值取决于报告中用户所选择的内容。
-  DAX表达式可能随时发生错误；最好能事先检测到错误条件，而不是让错误发生后再拦截它。
- 聚合器（如SUM）对于聚合列非常有用，而对于聚合表达式，则需要使用迭代器。迭代器通过扫描表格并逐行评估一个表达式来工作。在迭代结束时，迭代器根据其语义聚合结果。